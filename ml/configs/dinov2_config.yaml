# DINOv2 Fine-tuning Configuration for FolliCore
# Target: Trichoscopy/Dermoscopy Classification & Feature Extraction

model:
  name: "facebook/dinov2-base"
  pretrained: true
  num_classes: 7  # HAM10000 classes, adjust for trichoscopy
  freeze_backbone: false
  dropout: 0.1

data:
  train_dir: "data/processed/train"
  val_dir: "data/processed/val"
  test_dir: "data/processed/test"
  image_size: 224
  batch_size: 32
  num_workers: 4

augmentation:
  train:
    horizontal_flip: true
    vertical_flip: true
    rotation: 20
    brightness: 0.2
    contrast: 0.2
    saturation: 0.2
    hue: 0.1
    normalize:
      mean: [0.485, 0.456, 0.406]
      std: [0.229, 0.224, 0.225]
  val:
    normalize:
      mean: [0.485, 0.456, 0.406]
      std: [0.229, 0.224, 0.225]

training:
  epochs: 50
  learning_rate: 1.0e-4
  weight_decay: 0.01
  warmup_epochs: 5
  scheduler: "cosine"
  early_stopping:
    patience: 10
    min_delta: 0.001
  gradient_clip: 1.0
  mixed_precision: true  # FP16 training

optimizer:
  name: "AdamW"
  betas: [0.9, 0.999]
  eps: 1.0e-8

loss:
  name: "CrossEntropyLoss"
  label_smoothing: 0.1

metrics:
  - accuracy
  - f1_macro
  - auc_roc

checkpoint:
  save_dir: "models/checkpoints"
  save_best: true
  save_every: 5

logging:
  wandb:
    project: "follicore-ml"
    entity: null  # Set your wandb entity
    tags: ["dinov2", "trichoscopy"]
  tensorboard:
    log_dir: "runs/dinov2"

export:
  onnx:
    enabled: true
    output_path: "models/fine_tuned/dinov2-trichoscopy.onnx"
    opset_version: 17
    dynamic_axes:
      input: {0: "batch_size"}
      output: {0: "batch_size"}

# Hardware-specific settings
hardware:
  device: "cuda"  # cuda, cpu, mps
  seed: 42
  deterministic: true
